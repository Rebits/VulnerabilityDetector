package Tools;

import java.security.InvalidKeyException;
import java.security.Key;
import java.security.NoSuchAlgorithmException;
import java.util.Base64;
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.KeyGenerator;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import javax.crypto.spec.SecretKeySpec;


// Documentation page :  https://www.baeldung.com/java-cipher-class

public class Crypt {
    
    private final static String crypt_algorithn = "AES";

    public static String generateKey(int size) throws NoSuchAlgorithmException{
        KeyGenerator keyGen = KeyGenerator.getInstance(crypt_algorithn);
        keyGen.init(size);
        SecretKey secretKey = keyGen.generateKey(); 
        return Base64.getEncoder().encodeToString(secretKey.getEncoded());
    }   

    public static byte[] encrypt(String key, byte [] message){
       return Crypt.cryptoFunction(Cipher.ENCRYPT_MODE, key, message);
   }

   public static byte[] decrypt(String key, byte [] message){
       return Crypt.cryptoFunction(Cipher.DECRYPT_MODE, key, message);
   }
   
   private static byte [] cryptoFunction(int cipherMode, String key, byte [] message) {
       byte[] outputBytes = null;
       try {
           Key secretKey = new SecretKeySpec(key.getBytes(), crypt_algorithn);
           Cipher cipher = Cipher.getInstance(crypt_algorithn);
           cipher.init(cipherMode, secretKey);
           outputBytes = cipher.doFinal(message);
       } catch (NoSuchPaddingException | NoSuchAlgorithmException
                | InvalidKeyException | BadPaddingException
                | IllegalBlockSizeException ex) {
            System.out.println("Some error in cryptography funcion" + ex.getMessage());
       }
       return outputBytes;
    }
}







