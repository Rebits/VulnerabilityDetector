/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package VulnerabilityDetector;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

/**
 *
 * @author Víctor
 */
public class TestWeakPassword extends Test{

    public TestWeakPassword(Map testData) {
        super(testData);
    }

    @Override
    void createResult() {
        String list_user = result.output.get(0);
        System.out.println("RESULT   \n\n " + result.output.get(0));
        List<String> users = new ArrayList<>() ;
        result.message = "";
        if(list_user != null  & list_user.length() > 0){
            String[] output_command = list_user.split("\r\n|\r|\n", 2);
            if(output_command[0].contains("FIND USERS WITHOUT PASSWORD")){
                result.message += "Se han encontrado usuarios sin contraseña:  ";
                for(int i = 1 ; i< output_command.length;i++){
                   result.message += output_command[i];
                }
                result.resultCode = Integer.toString(0);
                result.severity = Integer.toString(2);
               System.out.println("La severidad es    : "  +  result.severity);

            }
            else{
                result.message += "Error imprevisto detectando contraseñas debiles de usuarios";
                result.resultCode = Integer.toString(0);
                result.severity = Integer.toString(2);  
            }
        }
        else{
                result.message += "Ningun usuario sin contraseña detectado";
                result.resultCode = Integer.toString(0);
                result.severity = Integer.toString(0);  
        }
    }
}
