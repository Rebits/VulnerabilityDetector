/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package VulnerabilityDetector;

import java.util.Map;

/**
 *
 * @author VÃ­ctor
 */
public class TestWindowsDefender extends Test {

    public TestWindowsDefender(Map testData) {
        super(testData);
    }

    @Override
    void createResult() {
        String antivirus_enabled = result.output.get(0);
        String AMServiceEnabled = result.output.get(1);
        String AntispywareEnabled = result.output.get(2);
        String OnAccessProtectionEnabled = result.output.get(3);
        String RealTimeProtectionEnabled = result.output.get(4);

        result.message = "";
        boolean correct_windows_defender = true;
        if(!antivirus_enabled.contains("True")){
            result.message += "Windows defender se encuentra desactivado\n";
            correct_windows_defender = false;
        }
        if(!AMServiceEnabled.contains("True")){
            result.message += "Windows defender amsservice se encuentra desactivado \n";
            correct_windows_defender = false;
        }
        if(!AntispywareEnabled.contains("True")){
            result.message += "Windows defender antispyware se encuentra desactivado \n";
            correct_windows_defender = false;
        }
        
        if(!OnAccessProtectionEnabled.contains("True")){
            result.message += "Windows defender onaccess protection se encuentra desactivado \n";
            correct_windows_defender = false;
        }        
        
        if(!RealTimeProtectionEnabled.contains("True")){
            result.message += "Windows defender realtime protection se encuentra desactivado \n";
            result.resultCode = Integer.toString(0);
            result.severity = Integer.toString(0);
        }
        if(correct_windows_defender){
            result.message = "Windows defender se encuentra correctamente configurado";
            result.resultCode = Integer.toString(0);
            result.severity = Integer.toString(0);
        }
        else{
            result.resultCode = Integer.toString(0);
            result.severity = Integer.toString(3);
        }
        result.message += "\n\n" + result.output.get(2); 
    } 
}
