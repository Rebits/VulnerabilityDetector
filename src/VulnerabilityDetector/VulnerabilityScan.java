/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */




package VulnerabilityDetector;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStream;
import java.lang.reflect.InvocationTargetException;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.ArrayList;
import java.util.List;

/**
 *
 * @author Víctor Rebollo Pérez
 */
//
public class VulnerabilityScan {
    String OS;
    String version;
    List<Test> tests;

    public VulnerabilityScan(List<Test> test_data) {
        OS = System.getProperty("os.name").toLowerCase();
        version = System.getProperty("os.version");
        tests = new ArrayList<>();
        for(int i = 0; i < test_data.size();i++){
            tests.add(test_data.get(i));
        }    }    
    
    public TestResult runTest(String test) throws NoSuchMethodException, IllegalAccessException, IllegalArgumentException, InvocationTargetException, IOException{
        TestResult result = null;
        for(Test t : tests){
            boolean test_available = false;
            String preset_os = null;        
            for ( Object key : (t.CommandExecuter).keySet() ) {
                if( this.OS.contains(key.toString()) || key.toString() == "All"){
                    test_available = true;
                    preset_os = key.toString();
                }   
            }  
            if(test_available){
                if(t.VulnerabilityName.contains(test)){
                    result = t.runTest(preset_os);
                    return result;
                }
            }
        }
        return result;
    }
    public List<TestResult> runAllTests() throws NoSuchMethodException, IllegalAccessException, IllegalArgumentException, InvocationTargetException, IOException{

        List<TestResult> all_result = new ArrayList<>() ;
        for (Test t : tests) {
            t.runTest(OS);
            all_result.add(t.getResult());
        }
        return all_result;
    }
    

    public List<TestResult> runTierTest(String tier) throws NoSuchMethodException, IllegalAccessException, IllegalArgumentException, InvocationTargetException, IOException{
        
        List<TestResult> result =  new ArrayList<>();
        for(Test t : tests){
            if(t.tier.contains(tier)){
                result.add(t.runTest(OS));
            }
        }
        return result;
    }
    public File createReport(List<TestResult> result){        
        String myDocuments = null;
        String path_string = "";
        File report = null;
        try {
            Process print_temporal_personal_forlder = null;
            if(OS.contains("windows")){
                print_temporal_personal_forlder =  Runtime.getRuntime().exec("reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\" /v personal");
                print_temporal_personal_forlder.waitFor();
                InputStream in = print_temporal_personal_forlder.getInputStream();
                byte[] b = new byte[in.available()];
                in.read(b);
                in.close();        
                myDocuments = new String(b);
                System.out.println(myDocuments);
                myDocuments = myDocuments.split("\\s\\s+")[4];    
                path_string = "\\";
                
            }
            else{
                myDocuments =  System.getProperty("user.home");
                path_string = "/";
            }
            DateTimeFormatter dtf = DateTimeFormatter.ofPattern("yyyy-MM-dd-HHmm");  
            LocalDateTime now = LocalDateTime.now();  
            report = new File(myDocuments  + path_string +  "filename-"+dtf.format(now)+".html");

            try {
                FileWriter myWriter = new FileWriter(report);
                StringBuilder html_head=new StringBuilder();
                StringBuilder resumen_operativo_div=new StringBuilder();
                StringBuilder test_results_div=new StringBuilder();
                StringBuilder html_end=new StringBuilder();
                //                html_head.append("<!DOCTYPE><html> <head> <style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css *//* Document ========================================================================== *//** * 1. Correct the line height in all browsers. * 2. Prevent adjustments of font size after orientation changes in iOS. */html { line-height: 1.15; /* 1 */ -webkit-text-size-adjust: 100%; /* 2 */}/* Sections ========================================================================== *//** * Remove the margin in all browsers. */body { margin: 0;}/** * Render the `main` element consistently in IE. */main { display: block;}/** * Correct the font size and margin on `h1` elements within `section` and * `article` contexts in Chrome, Firefox, and Safari. */h1 { font-size: 2em; margin: 0.67em 0;}/* Grouping content ========================================================================== *//** * 1. Add the correct box sizing in Firefox. * 2. Show the overflow in Edge and IE. */hr { box-sizing: content-box; /* 1 */ height: 0; /* 1 */ overflow: visible; /* 2 */}/** * 1. Correct the inheritance and scaling of font size in all browsers. * 2. Correct the odd `em` font sizing in all browsers. */pre { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */}/* Text-level semantics ========================================================================== *//** * Remove the gray background on active links in IE 10. */a { background-color: transparent;}/** * 1. Remove the bottom border in Chrome 57- * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari. */abbr[title] { border-bottom: none; /* 1 */ text-decoration: underline; /* 2 */ text-decoration: underline dotted; /* 2 */}/** * Add the correct font weight in Chrome, Edge, and Safari. */b,strong { font-weight: bolder;}/** * 1. Correct the inheritance and scaling of font size in all browsers. * 2. Correct the odd `em` font sizing in all browsers. */code,kbd,samp { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */}/** * Add the correct font size in all browsers. */small { font-size: 80%;}/** * Prevent `sub` and `sup` elements from affecting the line height in * all browsers. */sub,sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline;}sub { bottom: -0.25em;}sup { top: -0.5em;}/* Embedded content ========================================================================== *//** * Remove the border on images inside links in IE 10. */img { border-style: none;}/* Forms ========================================================================== *//** * 1. Change the font styles in all browsers. * 2. Remove the margin in Firefox and Safari. */button,input,optgroup,select,textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 1 */ line-height: 1.15; /* 1 */ margin: 0; /* 2 */}/** * Show the overflow in IE. * 1. Show the overflow in Edge. */button,input { /* 1 */ overflow: visible;}/** * Remove the inheritance of text transform in Edge, Firefox, and IE. * 1. Remove the inheritance of text transform in Firefox. */button,select { /* 1 */ text-transform: none;}/** * Correct the inability to style clickable types in iOS and Safari. */button,[type=\"button\"],[type=\"reset\"],[type=\"submit\"] { -webkit-appearance: button;}/** * Remove the inner border and padding in Firefox. */button::-moz-focus-inner,[type=\"button\"]::-moz-focus-inner,[type=\"reset\"]::-moz-focus-inner,[type=\"submit\"]::-moz-focus-inner { border-style: none; padding: 0;}/** * Restore the focus styles unset by the previous rule. */button:-moz-focusring,[type=\"button\"]:-moz-focusring,[type=\"reset\"]:-moz-focusring,[type=\"submit\"]:-moz-focusring { outline: 1px dotted ButtonText;}/** * Correct the padding in Firefox. */fieldset { padding: 0.35em 0.75em 0.625em;}/** * 1. Correct the text wrapping in Edge and IE. * 2. Correct the color inheritance from `fieldset` elements in IE. * 3. Remove the padding so developers are not caught out when they zero out * `fieldset` elements in all browsers. */legend { box-sizing: border-box; /* 1 */ color: inherit; /* 2 */ display: table; /* 1 */ max-width: 100%; /* 1 */ padding: 0; /* 3 */ white-space: normal; /* 1 */}/** * Add the correct vertical alignment in Chrome, Firefox, and Opera. */progress { vertical-align: baseline;}/** * Remove the default vertical scrollbar in IE 10+. */textarea { overflow: auto;}/** * 1. Add the correct box sizing in IE 10. * 2. Remove the padding in IE 10. */[type=\"checkbox\"],[type=\"radio\"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */}/** * Correct the cursor style of increment and decrement buttons in Chrome. */[type=\"number\"]::-webkit-inner-spin-button,[type=\"number\"]::-webkit-outer-spin-button { height: auto;}/** * 1. Correct the odd appearance in Chrome and Safari. * 2. Correct the outline style in Safari. */[type=\"search\"] { -webkit-appearance: textfield; /* 1 */ outline-offset: -2px; /* 2 */}/** * Remove the inner padding in Chrome and Safari on macOS. */[type=\"search\"]::-webkit-search-decoration { -webkit-appearance: none;}/** * 1. Correct the inability to style clickable types in iOS and Safari. * 2. Change font properties to `inherit` in Safari. */::-webkit-file-upload-button { -webkit-appearance: button; /* 1 */ font: inherit; /* 2 */}/* Interactive ========================================================================== *//* * Add the correct display in Edge, IE 10+, and Firefox. */details { display: block;}/* * Add the correct display in all browsers. */summary { display: list-item;}/* Misc ========================================================================== *//** * Add the correct display in IE 10+. */template { display: none;}/** * Add the correct display in IE 10. */[hidden] { display: none;} div.testset{ border: 3px solid black; text-align: center; margin: 0 0; } div.testset h2{ padding: 3%; font-size:200%; } div.resumen h2{ background-color: rgba(30,30,100,0.2); margin: 0; } div.resultados h2 { background-color: rgba(100,30,30,0.2); margin: 0; } div.test{ text-align: center; border-top: 1px solid black; font-size: 15px; margin:0 0; padding: 10%; } div.test h3{ padding:1%; margin-bottom: 10%;font-size: 140%; } table{ margin-left: auto; margin-right: auto; } </style> </head> <body> <div class=\"testset resumen\"> <h2> Resumen operativo </h2> <div class=\"test\"> <h3> Información del sistema operativo </h3> <div> <p> Info del sistema operativo </p> </div> </div> </div> <div class=\"testset resultados\"> <h2> Resultado de los tests </h2> <div class=\"test\"> <h3> Info del sistema operativo </h3> </div> </div> </body></html>");
//html_head.append("<!DOCTYPE><html> <head> <style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css *//* Document ========================================================================== *//** * 1. Correct the line height in all browsers. * 2. Prevent adjustments of font size after orientation changes in iOS. */html { line-height: 1.15; /* 1 */ -webkit-text-size-adjust: 100%; /* 2 */}/* Sections ========================================================================== *//** * Remove the margin in all browsers. */body { margin: 0;}/** * Render the `main` element consistently in IE. */main { display: block;}/** * Correct the font size and margin on `h1` elements within `section` and * `article` contexts in Chrome, Firefox, and Safari. */h1 { font-size: 2em; margin: 0.67em 0;}/* Grouping content ========================================================================== *//** * 1. Add the correct box sizing in Firefox. * 2. Show the overflow in Edge and IE. */hr { box-sizing: content-box; /* 1 */ height: 0; /* 1 */ overflow: visible; /* 2 */}/** * 1. Correct the inheritance and scaling of font size in all browsers. * 2. Correct the odd `em` font sizing in all browsers. */pre { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */}/* Text-level semantics ========================================================================== *//** * Remove the gray background on active links in IE 10. */a { background-color: transparent;}/** * 1. Remove the bottom border in Chrome 57- * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari. */abbr[title] { border-bottom: none; /* 1 */ text-decoration: underline; /* 2 */ text-decoration: underline dotted; /* 2 */}/** * Add the correct font weight in Chrome, Edge, and Safari. */b,strong { font-weight: bolder;}/** * 1. Correct the inheritance and scaling of font size in all browsers. * 2. Correct the odd `em` font sizing in all browsers. */code,kbd,samp { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */}/** * Add the correct font size in all browsers. */small { font-size: 80%;}/** * Prevent `sub` and `sup` elements from affecting the line height in * all browsers. */sub,sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline;}sub { bottom: -0.25em;}sup { top: -0.5em;}/* Embedded content ========================================================================== *//** * Remove the border on images inside links in IE 10. */img { border-style: none;}/* Forms ========================================================================== *//** * 1. Change the font styles in all browsers. * 2. Remove the margin in Firefox and Safari. */button,input,optgroup,select,textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 1 */ line-height: 1.15; /* 1 */ margin: 0; /* 2 */}/** * Show the overflow in IE. * 1. Show the overflow in Edge. */button,input { /* 1 */ overflow: visible;}/** * Remove the inheritance of text transform in Edge, Firefox, and IE. * 1. Remove the inheritance of text transform in Firefox. */button,select { /* 1 */ text-transform: none;}/** * Correct the inability to style clickable types in iOS and Safari. */button,[type=\\\"button\\\"],[type=\\\"reset\\\"],[type=\\\"submit\\\"] { -webkit-appearance: button;}/** * Remove the inner border and padding in Firefox. */button::-moz-focus-inner,[type=\\\"button\\\"]::-moz-focus-inner,[type=\\\"reset\\\"]::-moz-focus-inner,[type=\\\"submit\\\"]::-moz-focus-inner { border-style: none; padding: 0;}/** * Restore the focus styles unset by the previous rule. */button:-moz-focusring,[type=\\\"button\\\"]:-moz-focusring,[type=\\\"reset\\\"]:-moz-focusring,[type=\\\"submit\\\"]:-moz-focusring { outline: 1px dotted ButtonText;}/** * Correct the padding in Firefox. */fieldset { padding: 0.35em 0.75em 0.625em;}/** * 1. Correct the text wrapping in Edge and IE. * 2. Correct the color inheritance from `fieldset` elements in IE. * 3. Remove the padding so developers are not caught out when they zero out * `fieldset` elements in all browsers. */legend { box-sizing: border-box; /* 1 */ color: inherit; /* 2 */ display: table; /* 1 */ max-width: 100%; /* 1 */ padding: 0; /* 3 */ white-space: normal; /* 1 */}/** * Add the correct vertical alignment in Chrome, Firefox, and Opera. */progress { vertical-align: baseline;}/** * Remove the default vertical scrollbar in IE 10+. */textarea { overflow: auto;}/** * 1. Add the correct box sizing in IE 10. * 2. Remove the padding in IE 10. */[type=\\\"checkbox\\\"],[type=\\\"radio\\\"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */}/** * Correct the cursor style of increment and decrement buttons in Chrome. */[type=\\\"number\\\"]::-webkit-inner-spin-button,[type=\\\"number\\\"]::-webkit-outer-spin-button { height: auto;}/** * 1. Correct the odd appearance in Chrome and Safari. * 2. Correct the outline style in Safari. */[type=\\\"search\\\"] { -webkit-appearance: textfield; /* 1 */ outline-offset: -2px; /* 2 */}/** * Remove the inner padding in Chrome and Safari on macOS. */[type=\\\"search\\\"]::-webkit-search-decoration { -webkit-appearance: none;}/** * 1. Correct the inability to style clickable types in iOS and Safari. * 2. Change font properties to `inherit` in Safari. */::-webkit-file-upload-button { -webkit-appearance: button; /* 1 */ font: inherit; /* 2 */}/* Interactive ========================================================================== *//* * Add the correct display in Edge, IE 10+, and Firefox. */details { display: block;}/* * Add the correct display in all browsers. */summary { display: list-item;}/* Misc ========================================================================== *//** * Add the correct display in IE 10+. */template { display: none;}/** * Add the correct display in IE 10. */[hidden] { display: none;} div.testset{ border: 3px solid black; text-align: center; margin: 0 0; } div.testset h2{ padding: 3%; font-size:200%; } div.resumen h2{ background-color: rgba(30,30,100,0.2); margin: 0; } div.resultados h2 { background-color: rgba(100,30,30,0.2); margin: 0; } div.test{ text-align: center; border-top: 1px solid black; font-size: 15px; margin:0 0; padding: 10%; } div.test h3{ padding:1%; margin-bottom: 10%;font-size: 140%; } table{background-color:red; } </style> </head> <body> ");
html_head.append("<!DOCTYPE><html> <head> <style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css *//* Document ========================================================================== *//** * 1. Correct the line height in all browsers. * 2. Prevent adjustments of font size after orientation changes in iOS. */html { line-height: 1.15; /* 1 */ -webkit-text-size-adjust: 100%; /* 2 */}/* Sections ========================================================================== *//** * Remove the margin in all browsers. */body { margin: 0;}/** * Render the `main` element consistently in IE. */main { display: block;}/** * Correct the font size and margin on `h1` elements within `section` and * `article` contexts in Chrome, Firefox, and Safari. */h1 { font-size: 2em; margin: 0.67em 0;}/* Grouping content ========================================================================== *//** * 1. Add the correct box sizing in Firefox. * 2. Show the overflow in Edge and IE. */hr { box-sizing: content-box; /* 1 */ height: 0; /* 1 */ overflow: visible; /* 2 */}/** * 1. Correct the inheritance and scaling of font size in all browsers. * 2. Correct the odd `em` font sizing in all browsers. */pre { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */}/* Text-level semantics ========================================================================== *//** * Remove the gray background on active links in IE 10. */a { background-color: transparent;}/** * 1. Remove the bottom border in Chrome 57- * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari. */abbr[title] { border-bottom: none; /* 1 */ text-decoration: underline; /* 2 */ text-decoration: underline dotted; /* 2 */}/** * Add the correct font weight in Chrome, Edge, and Safari. */b,strong { font-weight: bolder;}/** * 1. Correct the inheritance and scaling of font size in all browsers. * 2. Correct the odd `em` font sizing in all browsers. */code,kbd,samp { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */}/** * Add the correct font size in all browsers. */small { font-size: 80%;}/** * Prevent `sub` and `sup` elements from affecting the line height in * all browsers. */sub,sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline;}sub { bottom: -0.25em;}sup { top: -0.5em;}/* Embedded content ========================================================================== *//** * Remove the border on images inside links in IE 10. */img { border-style: none;}/* Forms ========================================================================== *//** * 1. Change the font styles in all browsers. * 2. Remove the margin in Firefox and Safari. */button,input,optgroup,select,textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 1 */ line-height: 1.15; /* 1 */ margin: 0; /* 2 */}/** * Show the overflow in IE. * 1. Show the overflow in Edge. */button,input { /* 1 */ overflow: visible;}/** * Remove the inheritance of text transform in Edge, Firefox, and IE. * 1. Remove the inheritance of text transform in Firefox. */button,select { /* 1 */ text-transform: none;}/** * Correct the inability to style clickable types in iOS and Safari. */button,[type=\\\"button\\\"],[type=\\\"reset\\\"],[type=\\\"submit\\\"] { -webkit-appearance: button;}/** * Remove the inner border and padding in Firefox. */button::-moz-focus-inner,[type=\\\"button\\\"]::-moz-focus-inner,[type=\\\"reset\\\"]::-moz-focus-inner,[type=\\\"submit\\\"]::-moz-focus-inner { border-style: none; padding: 0;}/** * Restore the focus styles unset by the previous rule. */button:-moz-focusring,[type=\\\"button\\\"]:-moz-focusring,[type=\\\"reset\\\"]:-moz-focusring,[type=\\\"submit\\\"]:-moz-focusring { outline: 1px dotted ButtonText;}/** * Correct the padding in Firefox. */fieldset { padding: 0.35em 0.75em 0.625em;}/** * 1. Correct the text wrapping in Edge and IE. * 2. Correct the color inheritance from `fieldset` elements in IE. * 3. Remove the padding so developers are not caught out when they zero out * `fieldset` elements in all browsers. */legend { box-sizing: border-box; /* 1 */ color: inherit; /* 2 */ display: table; /* 1 */ max-width: 100%; /* 1 */ padding: 0; /* 3 */ white-space: normal; /* 1 */}/** * Add the correct vertical alignment in Chrome, Firefox, and Opera. */progress { vertical-align: baseline;}/** * Remove the default vertical scrollbar in IE 10+. */textarea { overflow: auto;}/** * 1. Add the correct box sizing in IE 10. * 2. Remove the padding in IE 10. */[type=\\\"checkbox\\\"],[type=\\\"radio\\\"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */}/** * Correct the cursor style of increment and decrement buttons in Chrome. */[type=\\\"number\\\"]::-webkit-inner-spin-button,[type=\\\"number\\\"]::-webkit-outer-spin-button { height: auto;}/** * 1. Correct the odd appearance in Chrome and Safari. * 2. Correct the outline style in Safari. */[type=\\\"search\\\"] { -webkit-appearance: textfield; /* 1 */ outline-offset: -2px; /* 2 */}/** * Remove the inner padding in Chrome and Safari on macOS. */[type=\\\"search\\\"]::-webkit-search-decoration { -webkit-appearance: none;}/** * 1. Correct the inability to style clickable types in iOS and Safari. * 2. Change font properties to `inherit` in Safari. */::-webkit-file-upload-button { -webkit-appearance: button; /* 1 */ font: inherit; /* 2 */}/* Interactive ========================================================================== *//* * Add the correct display in Edge, IE 10+, and Firefox. */details { display: block;}/* * Add the correct display in all browsers. */summary { display: list-item;}/* Misc ========================================================================== *//** * Add the correct display in IE 10+. */template { display: none;}/** * Add the correct display in IE 10. */[hidden] { display: none;} div.testset{ border: 3px solid black; text-align: center; margin: 0 0; } div.testset h2{ padding: 3%; font-size:200%; } div.resumen h2{ background-color: rgba(30,30,100,0.2); margin: 0; } div.resultados h2 { background-color: rgba(100,30,30,0.2); margin: 0; } div.test{ text-align: center; border-top: 1px solid black; font-size: 15px; margin:0 0; padding: 10%; } div.test h3{ padding:1%; margin-bottom: 10%;font-size: 140%; } table{border: 1px solid black;margin-right:auto;margin-left:auto; } </style> </head> <body> ");
// html_head.append("<!DOCTYPE><html> <head> <style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css *//* Document ========================================================================== *//** * 1. Correct the line height in all browsers. * 2. Prevent adjustments of font size after orientation changes in iOS. */html { line-height: 1.15; /* 1 */ -webkit-text-size-adjust: 100%; /* 2 */}/* Sections ========================================================================== *//** * Remove the margin in all browsers. */body { margin: 0;}/** * Render the `main` element consistently in IE. */main { display: block;}/** * Correct the font size and margin on `h1` elements within `section` and * `article` contexts in Chrome, Firefox, and Safari. */h1 { font-size: 2em; margin: 0.67em 0;}/* Grouping content ========================================================================== *//** * 1. Add the correct box sizing in Firefox. * 2. Show the overflow in Edge and IE. */hr { box-sizing: content-box; /* 1 */ height: 0; /* 1 */ overflow: visible; /* 2 */}/** * 1. Correct the inheritance and scaling of font size in all browsers. * 2. Correct the odd `em` font sizing in all browsers. */pre { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */}/* Text-level semantics ========================================================================== *//** * Remove the gray background on active links in IE 10. */a { background-color: transparent;}/** * 1. Remove the bottom border in Chrome 57- * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari. */abbr[title] { border-bottom: none; /* 1 */ text-decoration: underline; /* 2 */ text-decoration: underline dotted; /* 2 */}/** * Add the correct font weight in Chrome, Edge, and Safari. */b,strong { font-weight: bolder;}/** * 1. Correct the inheritance and scaling of font size in all browsers. * 2. Correct the odd `em` font sizing in all browsers. */code,kbd,samp { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */}/** * Add the correct font size in all browsers. */small { font-size: 80%;}/** * Prevent `sub` and `sup` elements from affecting the line height in * all browsers. */sub,sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline;}sub { bottom: -0.25em;}sup { top: -0.5em;}/* Embedded content ========================================================================== *//** * Remove the border on images inside links in IE 10. */img { border-style: none;}/* Forms ========================================================================== *//** * 1. Change the font styles in all browsers. * 2. Remove the margin in Firefox and Safari. */button,input,optgroup,select,textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 1 */ line-height: 1.15; /* 1 */ margin: 0; /* 2 */}/** * Show the overflow in IE. * 1. Show the overflow in Edge. */button,input { /* 1 */ overflow: visible;}/** * Remove the inheritance of text transform in Edge, Firefox, and IE. * 1. Remove the inheritance of text transform in Firefox. */button,select { /* 1 */ text-transform: none;}/** * Correct the inability to style clickable types in iOS and Safari. */button,[type=\"button\"],[type=\"reset\"],[type=\"submit\"] { -webkit-appearance: button;}/** * Remove the inner border and padding in Firefox. */button::-moz-focus-inner,[type=\"button\"]::-moz-focus-inner,[type=\"reset\"]::-moz-focus-inner,[type=\"submit\"]::-moz-focus-inner { border-style: none; padding: 0;}/** * Restore the focus styles unset by the previous rule. */button:-moz-focusring,[type=\"button\"]:-moz-focusring,[type=\"reset\"]:-moz-focusring,[type=\"submit\"]:-moz-focusring { outline: 1px dotted ButtonText;}/** * Correct the padding in Firefox. */fieldset { padding: 0.35em 0.75em 0.625em;}/** * 1. Correct the text wrapping in Edge and IE. * 2. Correct the color inheritance from `fieldset` elements in IE. * 3. Remove the padding so developers are not caught out when they zero out * `fieldset` elements in all browsers. */legend { box-sizing: border-box; /* 1 */ color: inherit; /* 2 */ display: table; /* 1 */ max-width: 100%; /* 1 */ padding: 0; /* 3 */ white-space: normal; /* 1 */}/** * Add the correct vertical alignment in Chrome, Firefox, and Opera. */progress { vertical-align: baseline;}/** * Remove the default vertical scrollbar in IE 10+. */textarea { overflow: auto;}/** * 1. Add the correct box sizing in IE 10. * 2. Remove the padding in IE 10. */[type=\"checkbox\"],[type=\"radio\"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */}/** * Correct the cursor style of increment and decrement buttons in Chrome. */[type=\"number\"]::-webkit-inner-spin-button,[type=\"number\"]::-webkit-outer-spin-button { height: auto;}/** * 1. Correct the odd appearance in Chrome and Safari. * 2. Correct the outline style in Safari. */[type=\"search\"] { -webkit-appearance: textfield; /* 1 */ outline-offset: -2px; /* 2 */}/** * Remove the inner padding in Chrome and Safari on macOS. */[type=\"search\"]::-webkit-search-decoration { -webkit-appearance: none;}/** * 1. Correct the inability to style clickable types in iOS and Safari. * 2. Change font properties to `inherit` in Safari. */::-webkit-file-upload-button { -webkit-appearance: button; /* 1 */ font: inherit; /* 2 */}/* Interactive ========================================================================== *//* * Add the correct display in Edge, IE 10+, and Firefox. */details { display: block;}/* * Add the correct display in all browsers. */summary { display: list-item;}/* Misc ========================================================================== *//** * Add the correct display in IE 10+. */template { display: none;}/** * Add the correct display in IE 10. */[hidden] { display: none;} div.testset{ border: 3px solid black; text-align: center; margin: 0 0; } div.testset h2{ padding: 3%; font-size:200%; } div.resumen h2{ background-color: rgba(30,30,100,0.2); margin: 0; } div.resultados h2 { background-color: rgba(100,30,30,0.2); margin: 0; } div.test{ text-align: center; border-top: 1px solid black; font-size: 15px; margin:0 0; padding: 10%; } div.test h3{ padding:1%; margin-bottom: 10%;font-size: 140%; } p{ } </style> </head> <body> ");
                html_end.append("</body></html>");
                resumen_operativo_div.append("<div class=\"testset resumen\"> <h2> Resumen operativo </h2>");    //   <div class=\"test\"> <h3> Información del sistema operativo </h3> <div> <p> Info del sistema operativo </p></div> </div> </div>
                test_results_div.append("<div class=\"testset resultados\"> <h2> Resultado de los tests </h2>"); // <div class=\"test\"> <h3> Info del sistema operativo </h3> </div> </div>       
                for(TestResult r : result){
                    if(r.tier.contains("report")){
                        resumen_operativo_div.append("<div class=\"test\">");
                        resumen_operativo_div.append("<h3> " + r.vulnerabilityName + "</h3>"); 
                        if (r.output != null){
                            for(String o : r.output){
                                resumen_operativo_div.append(o); 
                            }
                        }
                        resumen_operativo_div.append("</div>");
                    }
                    else{
                                   test_results_div.append("<div>");
                test_results_div.append("<h3> " + r.vulnerabilityName + "</h3>");
                test_results_div.append("<p>" +  r.message + "</p>");
                        if(!r.severity.contains("0")){
                test_results_div.append("<p> Severity: "  +  r.message + "</p>");
                        }
                test_results_div.append("<p> Output </p> <pre> " +  r.output + "</pre>");
                test_results_div.append("</div>");
                }
                }
                
               test_results_div.append("</div>");
                resumen_operativo_div.append(" </div> </div> ");
                myWriter.write(html_head.toString());
               myWriter.write(resumen_operativo_div.toString());
               myWriter.write(test_results_div.toString());
               myWriter.write(html_end.toString());
               myWriter.close();
            } catch (IOException e) {
                System.out.println("An error occurred.");
                e.printStackTrace();
            }
        } catch(Throwable t) {
            t.printStackTrace();
         }

        /*
        String report = "";
        report += "<-------------System information------------->" + "\n\n\n";
        for(TestResult r : result){
            if(r.tier.contains("information")){
                for(int i = 0 ; i < r.output.size(); i++){
                    report +=  "<------------------------------->" + r.output.get(i)+ "<------------------------------->" + "\n\n\n\n";
                }
            }
        }
        report += "<-------------Test result------------->" + "\n\n\n";

        for(TestResult r : result){
            if(!r.tier.contains("information")){
                report += "Testname:" + r.vulnerabilityName + "\n";
                report += "Date:" + r.date  + "\n" ;
                report += "TimeElapsed:" + r.timeElapsed  + "\n" ;
                report += "Severity:" + r.severity  + "\n";
                report += "ResultCode:" + r.resultCode  + "\n";
                report += "Message:" + r.message  + "\n" ;
                report += "Output:" + r.output  + "\n\n\n";
            }
        }
        
*/
        return report;
    } 

}
    