/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package VulnerabilityDetector;
import java.util.Map;

/**
 *
 * @author VÃ­ctor
 */
public class TestWindowsUpdate extends Test {
    public TestWindowsUpdate(Map testData) {
        super(testData);
    }
    @Override
    void createResult() {
      //  String command_output = (String) result.output.get(2);


        String n_updates = result.output.get(0);
       /* boolean end = false;
        for(int i = 0; i < command_output.length() && end == false;i++){
            if(Character.isDigit(command_output.charAt(i))){
                n_updates += (char) command_output.charAt(i);
            }
            else{
                end = true;
            }
        }
        */
        System.out.println("N UPDATES " + n_updates);
        String message_updates = result.output.get(1);
        int n_updates_number = Integer.parseInt(n_updates);
        if(n_updates_number > 0){ 
            result.message = "Tu sistema operativo esta desactualizado. Las actualizaciones pendientes son: \n\n" + message_updates;
            result.severity = Integer.toString(3);
            result.resultCode = Integer.toString(0);
        }
        else{
            result.message = "Tu sistema operativo esta actualizado.";
            result.severity = Integer.toString(0);
            result.resultCode = Integer.toString(0);        }
    }
}
