/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package VulnerabilityDetector;

import java.util.Map;

/**
 *
 * @author VÃ­ctor
 */
public class TestFirewall extends Test{

    public TestFirewall(Map testData) {
        super(testData);
    }

    @Override
    void createResult() {
        String public_firewall = result.output.get(0);
        String private_firewall = result.output.get(1);
        String domain_firewall = result.output.get(2);
        result.message = "";
        boolean correct_firewall = true;
        if(!public_firewall.contains("True")){
            result.message += "Tu firewall public esta desactivado\n";
            correct_firewall = false;
        }
        if(!private_firewall.contains("True")){
            result.message += "Tu firewall privado esta desactivado\n";
            correct_firewall = false;
        }
        if(!domain_firewall.contains("True")){
            result.message = "Tu firewall de dominio esta desactivado\n";
            correct_firewall = false;
        }
        if(correct_firewall){
            result.message = "Firewall correctamente activado";
            result.resultCode = Integer.toString(0);
            result.severity = Integer.toString(0);
        }
        else{
            result.resultCode = Integer.toString(0);
            result.severity = Integer.toString(3);
        }
        result.message += "\n\n" + result.output.get(2); 
    }
}
